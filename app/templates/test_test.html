{% extends '_mybase.html' %}

{% block content %}
  {{ super() }}

<div>
</div>
<div>
  <a href="{{ url_for('blue_test.vf_cmd_start') }}" class="btn btn-default">开始</a>
</div>

  {%- for message in get_flashed_messages() %}
<div class="alert alert-dismissible alert-success">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  <strong>{{ message }}</strong> 
</div>
  {% endfor %}

<table class="table table-striped table-hover ">
  <thead>
    <tr>
      <th>#</th>
      <th>设备类型</th>
      <th>工厂</th>
      <th>固件版本</th>
      <th>RSSI_BLE</th>
      <th>RSSI_WIFI</th>
      <th>MAC_BLE</th>
      <th>MAC_WIFI</th>
      <th>合格</th>
      <th>云同步</th>
      <th>时间</th>
      <th colspan="2">控制</th>
    </tr>
  </thead>
  <tbody>
    {% for result in results %}
    {% if loop.index|string == control_index %}
    <tr class="active">
    {% elif not result.is_qualified %}
    <tr class="warning">
    {% else %}
    <tr class="info">
    {% endif %}
      <td>{{ loop.index}}</td>
      <td>{{result.device_type}}</td>
      <td>{{result.factory}}</td>
      <td>{{result.fw_version}}</td>
      <td>{{result.rssi_ble}}</td>
      <td>{{result.rssi_wifi}}</td>
      <td>{{result.mac_ble}}</td>
      <td>{{result.mac_wifi}}</td>
      <td>{{result.is_qualified}}</td>
      <td>{{result.is_sync}}</td>
      <td>{{result.datetime}}</td>
      <td>
        <form action = "{{url_for('blue_test.vf_cmd_on_off')}}" method = "post">
          <input type = "hidden" name = "index" value= {{loop.index }} />
          <input type = "hidden" name = "mac" value="{{result.mac_ble}}" />
          <input type = "hidden" name = "on_off" value="on" />
          <button type="submit" >on</button>
        </form>
      </td>
      <td>
        <form action = "{{url_for('blue_test.vf_cmd_on_off')}}" method = "post">
          <input type = "hidden" name = "index" value= {{loop.index}} />
          <input type = "hidden" name = "mac" value="{{result.mac_ble}}" />
          <input type = "hidden" name = "on_off" value="off" />
          <button type="submit" >off</button>
        </form>
      </td>
    </tr>
    {% else %}
    {% endfor %}
  </tbody>
</table> 

  {%- for message in get_flashed_messages() %}
<div class="alert alert-dismissible alert-success">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  <strong>{{ message }}</strong> 
</div>
  {% endfor %}

<div>
  <div>
  </div>
<div>
  <br>
  <br>


{% endblock %}


